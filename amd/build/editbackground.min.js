define ("contenttype_repurpose/editbackground",["exports","contenttype_repurpose/formupdate","core/fragment","core/modal_events","core/modal_factory","core/notification","core/str","core/templates"],function(a,b,c,d,e,f,g,h){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.edit=a.init=void 0;b=i(b);c=i(c);d=i(d);e=i(e);f=i(f);h=i(h);function i(a){return a&&a.__esModule?a:{default:a}}var j=function(a,b){var c;e.default.create({large:!1,title:(0,g.get_string)("addfile","contenttype_repurpose"),type:e.default.types.SAVE_CANCEL,body:""}).then(function(f){var g=f.getRoot();g.on("submit",function(d){var e=new FormData(g.find("form").get(0));d.stopPropagation();d.preventDefault();l(a,b,c,e,f);f.hide()});g.on(d.default.save,function(d){var e=new FormData(g.find("form").get(0));d.stopPropagation();d.preventDefault();l(a,b,c,e,f);f.hide()});document.addEventListener("click",function(d){var e=d.target.closest("[data-action=\"edit\"], button[name=\"backgroundimage[addfile]\"]");if(e){d.stopPropagation();d.preventDefault();c=d.target.closest("form");k(a,b,c,e,f)}},!0)}).fail(f.default.exception);document.addEventListener("click",m.bind(window,a,b))};a.init=j;var k=function(a,b,d,e,g){var i=new FormData(d),j={draftid:i.get("draftid")},k={contextid:a,library:b};k.jsonformdata=JSON.stringify(j);c.default.loadFragment("contenttype_repurpose","addfile",a,k).done(function(a,b){g.show();h.default.replaceNodeContents(g.getRoot().find(".modal-body"),a,b)}).fail(f.default.exception)},l=function(a,d,e,g,i){var j={},k={contextid:a,library:d};g.forEach(function(a,b){j[b]=a});k.jsonformdata=JSON.stringify(j);c.default.loadFragment("contenttype_repurpose","addfile",a,k).done(function(c,f){var g=JSON.parse(c);if(g){e.querySelector("input[name=\"background\"]").setAttribute("value",g.params.file.path);b.default.updateForm(a,d,e)}else{i.show();h.default.replaceNodeContents(i.getRoot().find(".modal-body"),c,f)}}).fail(f.default.exception)},m=function(a,c,d){var e=d.target.closest("[data-action=\"delete\"]");if(e){var f=e.closest("form");d.stopPropagation();d.preventDefault();f.querySelector("input[name=\"background\"]").setAttribute("value","");b.default.updateForm(a,c,f)}};a.edit=m});
//# sourceMappingURL=editbackground.min.js.map
